{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction History</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- jQuery for easier DOM manipulation -->
    <link rel="stylesheet" href="{% static 'history/history.css' %}"> <!-- TODO: finalize CSS -->
</head>
<body>
    <h1>Transaction History</h1>
    <table id="transaction-table">
        <thead>
            <tr>
                <th>Company Name</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Type</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be populated here by JavaScript -->
        </tbody>
    </table>

    <script>
        $(document).ready(function() {
            // Get user history from Django context variable
            const userHistory = {{ user_history|safe }};
            
            // Populate the table with transaction history
            const $tableBody = $('#transaction-table tbody');
            userHistory.forEach(transaction => {
                const row = `<tr>
                    <td>${transaction.name}</td>
                    <td>${transaction.quantity}</td>
                    <td>${transaction.price}</td>
                    <td>${transaction.type}</td>
                    <td>${new Date(transaction.date).toLocaleString()}</td>
                </tr>`;
                $tableBody.append(row);
            });
        });
    </script>
</body>
</html>